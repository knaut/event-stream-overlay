<html>
<head>
  <link rel="stylesheet" href="index.css"/>
</head>
<body>
  <!-- <h1>SSE: <span id="state"></span></h1> -->
  <h3>Data: <span id="data"></span></h3>

  <div class="accelerometer left">
    <div class="pitch">
      <span class="box"/>
      <span>pitch</span>
    </div>
    <div class="roll">
      <span class="box"/>
      <span>roll</span>
    </div>
  </div>

  <div class="accelerometer right">
    <div class="pitch">
      <span class="box"/>
      <span>pitch</span>
    </div>
    <div class="roll">
      <span class="box"/>
      <span>roll</span>
    </div>
  </div>

  <div class="gesture left">
    <span>none</span>
    <span>wave out</span>
    <span>wave in</span>
    <span>fist</span>
    <span>fingers spread</span>
    <span>double tap</span>
  </div>

  <div class="gesture right">
    <span>none</span>
    <span>wave out</span>
    <span>wave in</span>
    <span>fist</span>
    <span>fingers spread</span>
    <span>double tap</span>
  </div>

  <div class="gyro left">
    <span>hit</span>
  </div>

  <div class="gyro right">
    <span>hit</span>
  </div>

  <div class="emg left">
    <span>EMGs</span>
    <div></div>
    <div></div>
    <div></div>
    <div></div>
    
    <div></div>
    <div></div>
    <div></div>
    <div></div>
  </div>

  <div class="emg right">
    <span>EMGs</span>
    <div></div>
    <div></div>
    <div></div>
    <div></div>
    
    <div></div>
    <div></div>
    <div></div>
    <div></div>
  </div>

  <div id="media-control">
    <!-- could be like a slider + buttons -->
  </div>

  <script>
    const leftGyro = document.querySelector('div.gyro.left')
    const rightGyro = document.querySelector('div.gyro.right')

    

    var source = new EventSource('/osc')

    source.addEventListener('message', function(e) {

      const data = e.data


      const splitVal = data.split(',')

      

      const splitAddr = splitVal[0].split('/')

      // console.log(splitAddr, splitVal)

      const firstTwo = splitAddr[2].substring(0, 2)
      const param = splitAddr[2].substring(2, splitAddr[2].length)

      let arm = ''
      if (firstTwo === '0_' || firstTwo === '1_') {
        if (firstTwo === '0_') {
          arm = 'left'
        }

        if (firstTwo === '1_') {
          arm = 'right'
        }
      } else {
        arm = null
      }

      const value = splitVal[1] === 'true' ? true : (
        splitVal[1] === 'false' ? false : (
          parseFloat( splitVal[1] ) ? parseFloat( splitVal[1] ) : splitVal[1]
        )
      )

      const msg = {
        type: splitAddr[1],
        arm,
        param,
        value
      }

      console.log(msg)



      switch (msg.type) {
        case 'gyro':
          if (msg.arm === 'left') {
            if (value === true) {
              leftGyro.classList.add('on')
            }

            if (value === false) {
              leftGyro.classList.remove('on')
            }
          }

          if (msg.arm === 'right') {
            if (value === true) {
              rightGyro.classList.add('on')
            }

            if (value === false) {
              rightGyro.classList.remove('on')
            }
          }
        break;
        case 'accel':

          if (msg.arm === 'left') {

          }

        break; 
      }

    }, false)

  </script>

</body>
</html>